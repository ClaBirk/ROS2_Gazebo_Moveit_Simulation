<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="KR_10" >

  <!-- Base -->

    <!-- World fixed joint-->
    <link name="world" />
    <joint name="world_fixed" type="fixed">
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <parent link="world"/>
      <child link="base_0"/>
    </joint>
  
  <link name="base_0">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/base_link.stl" />
     </geometry>
        <material name="">
         <color rgba="${ 14/255} ${ 14/255} ${ 16/255} 1.0"/>
      </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/base_link.stl" />
     </geometry>
   </collision>
   <inertial>
     <mass value="14" /> 
      <inertia ixx="0.08877213773" ixy="-0.000131033070251" ixz="-0.00150261923247" iyy="0.14293778144" iyz="-2.25256850538e-05" izz="0.126259385464" /> 
     <origin xyz="-0.0444859 -4.97e-05 0.1100921" rpy="0 0 0" />
     </inertial>
  </link>


  <link name="link1">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_1.stl" />
     </geometry>
        <material name="">
         <color rgba="${246/255} ${120/255} ${ 40/255} 1.0"/>
        </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_1.stl" />
     </geometry>
   </collision>
     <inertial>
     <origin xyz="0.0146723 5.46e-05 -0.0557645" rpy="0 0 0" />
      <mass value="11.2" /> 
      <inertia ixx="0.10800091083" ixy="0.000256908100066" ixz="-0.00448959204754" iyy="0.0892932854513" iyz="-0.000186133409604" izz="0.0838171097348" />
     </inertial>
  </link>

  <link name="link2">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_2.stl"/>
     </geometry>
        <material name="">
   <color rgba="${246/255} ${120/255} ${ 40/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_2.stl" />
     </geometry>
   </collision>
   <inertial>
     <mass value="8.4" />
     <inertia ixx="0.0365241429014" ixy="0.00223732223794" ixz="-0.00177293915942" iyy="0.378539351981" iyz="2.8964263294e-06" izz="0.392538210121" />
     <origin xyz="0.2482357 -0.0029221 0.0079418" rpy="0 0 0" />
   </inertial>
  </link>

  
  <link name="link3">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_3.stl" />
     </geometry>
        <material name="">
   <color rgba="${246/255} ${120/255} ${ 40/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_3.stl" />
     </geometry>
   </collision>
   <inertial>
     <origin xyz="0.0160924 2.38e-05 0.0105013" rpy="0 0 0" />
        <mass value="8.4" />
   <inertia ixx="0.0238712171376" ixy="1.72719757663e-06" ixz="-0.00409828855491" iyy="0.0325090200419" iyz="-1.11535979101e-05" izz="0.0287380207905" />
</inertial>
   
     
  </link>
  <link name="link4">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_4.stl" />
     </geometry>
        <material name="">
   <color rgba="${246/255} ${120/255} ${ 40/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_4.stl" />
     </geometry>
   </collision>
   <inertial>
     <mass value="5.6" />
     <inertia ixx="0.0101469645454" ixy="0.000122992246096" ixz="-8.45337146292e-05" iyy="0.070495864179" iyz="8.8953596453e-07" izz="0.0717697213772" />
      <origin xyz="0.301148 -0.0004543 0.000235" rpy="0 0 0" />
      </inertial>
  </link>

  <link name="link5">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_5.stl" />
     </geometry>
        <material name="">
   <color rgba="${246/255} ${120/255} ${ 40/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_5.stl" />
     </geometry>
   </collision>
     <inertial>
        <mass value="5.6" />
     <inertia ixx="0.00402901710341" ixy="0.000210543968708" ixz="4.6068390983e-05" iyy="0.00668778512296" iyz="1.26910167997e-06" izz="0.00711775677213" />
     <origin xyz="0.0157906 0.0019162 -0.0002449" rpy="0 0 0" />
      </inertial>
  </link>

  <link name="link6">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/visual/link_6.stl" />
     </geometry>
        <material name="">
   <color rgba="${40/255} ${246/255} ${ 0/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <mesh filename="$(find ros_sim)/meshes/collision/link_6.stl" />
     </geometry>
   </collision>
   <inertial>
      <mass value="2.8" />
      <inertia ixx="0.000603033772181" ixy="-0.0" ixz="-4.00686891815e-06" iyy="-4.00686891815e-06" iyz="-0.0" izz="0.000340583858042" />
     <origin xyz="-0.0075312 1e-07 -0.0009341" rpy="0 0 0" />
     </inertial>  
  </link>
  
  <!-- der Werkzeughalter -->
  <link name="flange">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
        <mesh filename="$(find ros_sim)/meshes/visual/werkzeughalter_v2.stl" />
     </geometry>
        <material name="">
   <color rgba="${40/255} ${246/255} ${ 0/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
        <mesh filename="$(find ros_sim)/meshes/visual/werkzeughalter_v2.stl" />
     </geometry>
   </collision>
   <inertial>
     <inertia ixx="1.03065e+03" ixy="-3.2293975e+01" ixz="-2.9860657e+02" iyy="1.1628735e+03" iyz="-1.5650836e+01" izz="8.9319503e+02" />
        <mass value="0.670" />
     <origin xyz="0.0160924 2.38e-05 0.0105013" rpy="0 0 0" />
   </inertial>
  </link>

  <!--tool0 -->
  <link name="tool0">
   <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
        <mesh filename="$(find ros_sim)/meshes/visual/spindel_v1.stl" />
     </geometry>
        <material name="">
   <color rgba="${40/255} ${246/255} ${ 0/255} 1.0"/>
  </material>
   </visual>
   <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
        <mesh filename="$(find ros_sim)/meshes/visual/spindel_v1.stl" />
     </geometry>
   </collision>
   <inertial>
     <origin xyz="0.0160924 2.38e-05 0.0105013" rpy="0 0 0" />
        <mass value="0.670" />
   <inertia ixx="1.03065e+03" ixy="-3.2293975e+01" ixz="-2.9860657e+02" iyy="1.1628735e+03" iyz="-1.5650836e+01" izz="8.9319503e+02" />
   </inertial>
  </link> 

  <!-- Joints definieren _______________________________________________________________________-->
   <joint name="joint1" type="revolute">
     <origin xyz="0 0 0.400" rpy="0 0 0"/>
     <parent link="base_0"/>
     <child link="link1"/>
     <axis xyz="0 0 -1"/>
     <limit effort="0" lower="${radians(-170)}" upper="${radians(170)}" velocity="${radians(300)}"/>
   </joint>
   <joint name="joint2" type="revolute">
     <origin xyz="0.025 0 0" rpy="0 0 0"/>
     <parent link="link1"/>
     <child link="link2"/>
     <axis xyz="0 1 0"/>
     <limit effort="0" lower="${radians(-190)}" upper="${radians(45)}" velocity="${radians(225)}"/>
   </joint>
   <joint name="joint3" type="revolute">
     <origin xyz="0.560 0 0" rpy="0 0 0"/>
     <parent link="link2"/>
     <child link="link3"/>
     <axis xyz="0 1 0"/>
     <limit effort="0" lower="${radians(-120)}" upper="${radians(156)}" velocity="${radians(225)}"/>
   </joint>
   <joint name="joint4" type="revolute">
     <origin xyz="0 0 0.035" rpy="0 0 0"/>
     <parent link="link3"/>
     <child link="link4"/>
     <axis xyz="-1 0 0"/>
     <limit effort="0" lower="${radians(-185)}" upper="${radians(185)}" velocity="${radians(381)}"/>
   </joint>
   <joint name="joint5" type="revolute">
     <origin xyz="0.515 0 0" rpy="0 0 0"/>
     <parent link="link4"/>
     <child link="link5"/>
     <axis xyz="0 1 0"/>
     <limit effort="0" lower="${radians(-120)}" upper="${radians(120)}" velocity="${radians(311)}"/>
   </joint>
   <joint name="joint6" type="revolute">
     <origin xyz="0.080 0 0" rpy="0 0 0"/>
     <parent link="link5"/>
     <child link="link6"/>
     <axis xyz="-1 0 0"/>
     <limit effort="0" lower="${radians(-350)}" upper="${radians(350)}" velocity="${radians(492)}"/>
   </joint>
   <joint name="joint6-flange" type="fixed">
     <parent link="link6"/>
     <child link="flange"/>
     <origin xyz="0.01 0.04 -0.053" rpy="0 0 -1.57"/>
   </joint>
   <joint name="flange-tool0" type="fixed">
     <parent link="flange"/>
     <child link="tool0"/>
     <origin xyz="0.04 0.054 0.037" rpy="0 0 1.507"/>
   </joint>


<ros2_control name="GazeboSystem" type="system">
   <hardware>
      <plugin>gazebo_ros2_control/GazeboSystem</plugin>
    </hardware>

    <joint name="joint1">
       <command_interface name="position">
          <param name="min">-6.2832</param>
          <param name="max">6.2832</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>

    <joint name="joint2">
       <command_interface name="position">
          <param name="min">-6.2832</param>
          <param name="max">6.2832</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>

    <joint name="joint3">
       <command_interface name="position">
          <param name="min">-2.7925</param>
          <param name="max">2.7925</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>

    <joint name="joint4">
       <command_interface name="position">
          <param name="min">-6.2832</param>
          <param name="max">6.2832</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>


    <joint name="joint5">
       <command_interface name="position">
          <param name="min">-6.2832</param>
          <param name="max">6.2832</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>


    <joint name="joint6">
       <command_interface name="position">
          <param name="min">-6.2832</param>
          <param name="max">6.2832</param>
       </command_interface>
       <state_interface name="position"/>
       <state_interface name="velocity"/>
       <state_interface name="effort"/>
    </joint>
  </ros2_control>

<gazebo>
   <plugin name="gazebo_ros2_control" filename="libgazebo_ros2_control.so">
        
        <!--<robot_sim_type>gazebo_ros2_control/DefaultRobotHWSim</robot_sim_type> --> 
      
      <robot_sim_type>gazebo_ros2_control/GazeboSystem</robot_sim_type>
      <parameters>$(find ros_sim)/config/KR10_controller.yaml</parameters>   

    </plugin>
</gazebo>


<!-- Transmission 1 -->
<transmission name="tran1">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint1">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor1">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>
<!-- Transmission 2 -->
<transmission name="tran2">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint2">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor2">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>
<!-- Transmission 3 -->
<transmission name="tran3">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint3">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor3">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>
<!-- Transmission 4 -->
<transmission name="tran4">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint4">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor4">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>
<!-- Transmission 5 -->
<transmission name="tran5">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint5">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor5">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>
<!-- Transmission 6 -->
<transmission name="tran6">
   <type>transmission_interface/SimpleTransmission</type>
   <joint name="joint6">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
   </joint>
   <actuator name="motor6">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
   </actuator>
</transmission>


 <!-- Base -->
 <gazebo reference="base_0">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>

  <!-- Link1 -->
  <gazebo reference="link1">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>
  
  <!-- Link2 -->
  <gazebo reference="link2">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>
  
  <!-- Link3 -->
  <gazebo reference="link3">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>
  
  <!-- Link4 -->
  <gazebo reference="link4">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>
  
  <!-- Link5 -->
  <gazebo reference="link5">    
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>
  
  <!-- Link6 -->
  <gazebo reference="link6">
   <kp>1000000.0</kp>
   <kd>100.0</kd>
   <mu1>30.0</mu1>
   <mu2>30.0</mu2>
   <maxVel>1.0</maxVel>
   <minDepth>0.001</minDepth>
  </gazebo>

<gazebo reference="link1">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="link2">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="link3">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="link4">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="link5">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="link6">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="flange">
   <selfCollide>true</selfCollide>
   </gazebo>
   <gazebo reference="tool0">
   <selfCollide>true</selfCollide>
   </gazebo>


  <gazebo reference="world">
     <static>true</static>
   </gazebo>
  <gazebo reference="base_link">
   <material>Gazebo/Black</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>
  <gazebo reference="link1">
   <material>Gazebo/Orange</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>
  <gazebo reference="link2">
   <material>Gazebo/Orange</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>  
  <gazebo reference="link3">
   <material>Gazebo/Orange</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>
  <gazebo reference="link4">
   <material>Gazebo/Orange</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>
  <gazebo reference="link5">
   <material>Gazebo/Orange</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>
  <gazebo reference="link6">
   <material>Gazebo/Green</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo> 
  <gazebo reference="flange">
   <material>Gazebo/Green</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo> 
  <gazebo reference="tool0">
   <material>Gazebo/Green</material>
   <turnGravityOff>true</turnGravityOff>
  </gazebo>

</robot>
